<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PR Analysis Flow Diagram</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
        }
        .diagram-container {
            overflow-x: auto;
            margin-bottom: 30px;
        }
        svg {
            display: block;
            margin: 0 auto;
        }
        .node rect {
            stroke: #333;
            stroke-width: 1.5px;
            fill: white;
        }
        .node.api rect {
            fill: #d4e6f1;
            stroke: #3498db;
        }
        .node.process rect {
            fill: #d5f5e3;
            stroke: #2ecc71;
        }
        .node.output rect {
            fill: #fef9e7;
            stroke: #f1c40f;
        }
        .node.highlight rect {
            fill: #fadbd8;
            stroke: #e74c3c;
        }
        .edgePath path {
            stroke: #333;
            stroke-width: 1.5px;
            fill: none;
        }
        .node text {
            font-size: 14px;
            font-weight: 500;
        }
        .legend {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 15px 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            border: 1px solid #333;
        }
        .api-color {
            background-color: #d4e6f1;
            border-color: #3498db;
        }
        .process-color {
            background-color: #d5f5e3;
            border-color: #2ecc71;
        }
        .output-color {
            background-color: #fef9e7;
            border-color: #f1c40f;
        }
        .highlight-color {
            background-color: #fadbd8;
            border-color: #e74c3c;
        }
        .tab-container {
            margin-top: 30px;
        }
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 10px 20px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            cursor: pointer;
            font-weight: 500;
        }
        .tab-button.active {
            background-color: white;
            border-bottom: 2px solid white;
            margin-bottom: -1px;
            color: #3498db;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PR Analysis Flow Diagram</h1>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color api-color"></div>
                <span>API Interaction</span>
            </div>
            <div class="legend-item">
                <div class="legend-color process-color"></div>
                <span>Processing</span>
            </div>
            <div class="legend-item">
                <div class="legend-color output-color"></div>
                <span>Output/Results</span>
            </div>
            <div class="legend-item">
                <div class="legend-color highlight-color"></div>
                <span>Key Analysis</span>
            </div>
        </div>
        
        <div class="tab-buttons">
            <div class="tab-button active" onclick="showTab('main-flow')">Main Flow</div>
            <div class="tab-button" onclick="showTab('defect-flow')">Defect Analysis</div>
            <div class="tab-button" onclick="showTab('guidelines-flow')">Guidelines Analysis</div>
        </div>
        
        <div class="tab-content active" id="main-flow">
            <div class="diagram-container">
                <svg width="1000" height="800" viewBox="0 0 1000 800">
                    <!-- Main Flow Diagram -->
                    
                    <!-- Data Collection -->
                    <g class="node api" transform="translate(500, 50)">
                        <rect width="220" height="80" rx="5" ry="5" x="-110" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">1. Data Collection</text>
                        <text x="0" y="5" text-anchor="middle">Fetch PRs and Commits</text>
                        <text x="0" y="25" text-anchor="middle">from GitHub API</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,90 L500,130" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- PR Processing -->
                    <g class="node process" transform="translate(500, 170)">
                        <rect width="220" height="80" rx="5" ry="5" x="-110" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">2. PR Processing Loop</text>
                        <text x="0" y="5" text-anchor="middle">Extract metadata, calculate</text>
                        <text x="0" y="25" text-anchor="middle">metrics, fetch PR files</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,210 L500,250" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Parallel Analysis -->
                    <g class="node highlight" transform="translate(500, 290)">
                        <rect width="220" height="60" rx="5" ry="5" x="-110" y="-30"></rect>
                        <text x="0" y="5" text-anchor="middle">3. Parallel Analysis Tracks</text>
                    </g>
                    
                    <!-- Branches -->
                    <path d="M500,320 L500,340 L300,340 L300,370" class="edgePath" marker-end="url(#arrowhead)"></path>
                    <path d="M500,320 L500,340 L700,340 L700,370" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Contributor Analysis -->
                    <g class="node process" transform="translate(300, 410)">
                        <rect width="180" height="80" rx="5" ry="5" x="-90" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">Contributor Analysis</text>
                        <text x="0" y="5" text-anchor="middle">Track PRs per contributor</text>
                        <text x="0" y="25" text-anchor="middle">Calculate metrics</text>
                    </g>
                    
                    <!-- File Analysis -->
                    <g class="node process" transform="translate(700, 410)">
                        <rect width="180" height="80" rx="5" ry="5" x="-90" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">File Analysis</text>
                        <text x="0" y="5" text-anchor="middle">Track changes per file</text>
                        <text x="0" y="25" text-anchor="middle">Identify hotspots</text>
                    </g>
                    
                    <!-- Second level branches -->
                    <path d="M300,450 L300,470 L300,490" class="edgePath" marker-end="url(#arrowhead)"></path>
                    <path d="M700,450 L700,470 L700,490" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Defect Area Analysis -->
                    <g class="node highlight" transform="translate(300, 530)">
                        <rect width="180" height="80" rx="5" ry="5" x="-90" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">Defect Area Analysis</text>
                        <text x="0" y="5" text-anchor="middle">Identify DEF PRs</text>
                        <text x="0" y="25" text-anchor="middle">Track affected directories</text>
                    </g>
                    
                    <!-- PR Guidelines Analysis -->
                    <g class="node highlight" transform="translate(700, 530)">
                        <rect width="180" height="80" rx="5" ry="5" x="-90" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">PR Guidelines Analysis</text>
                        <text x="0" y="5" text-anchor="middle">Check size, open time,</text>
                        <text x="0" y="25" text-anchor="middle">review time, comments</text>
                    </g>
                    
                    <!-- Merge branches -->
                    <path d="M300,570 L300,590 L500,590 L500,610" class="edgePath" marker-end="url(#arrowhead)"></path>
                    <path d="M700,570 L700,590 L500,590 L500,610" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Data Aggregation -->
                    <g class="node output" transform="translate(500, 650)">
                        <rect width="220" height="80" rx="5" ry="5" x="-110" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">4. Data Aggregation</text>
                        <text x="0" y="5" text-anchor="middle">Format statistics</text>
                        <text x="0" y="25" text-anchor="middle">Generate summary data</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,690 L500,730" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Frontend Visualization -->
                    <g class="node output" transform="translate(500, 770)">
                        <rect width="220" height="80" rx="5" ry="5" x="-110" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">5. Frontend Visualization</text>
                        <text x="0" y="5" text-anchor="middle">Render charts and tables</text>
                        <text x="0" y="25" text-anchor="middle">Display statistics</text>
                    </g>
                    
                    <!-- Arrowhead definition -->
                    <defs>
                        <marker id="arrowhead" viewBox="0 0 10 10" refX="9" refY="5"
                            markerWidth="6" markerHeight="6" orient="auto">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#333"></path>
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>
        
        <div class="tab-content" id="defect-flow">
            <div class="diagram-container">
                <svg width="1000" height="600" viewBox="0 0 1000 600">
                    <!-- Defect Analysis Flow Diagram -->
                    
                    <!-- DEF PR Identification -->
                    <g class="node highlight" transform="translate(500, 50)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">1. DEF PR Identification</text>
                        <text x="0" y="5" text-anchor="middle">Filter PRs with titles starting with</text>
                        <text x="0" y="25" text-anchor="middle">"DEF", "def", or "Def"</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,90 L500,130" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- File Processing -->
                    <g class="node process" transform="translate(500, 170)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">2. File Processing</text>
                        <text x="0" y="5" text-anchor="middle">For each DEF PR, process all modified files</text>
                        <text x="0" y="25" text-anchor="middle">Extract directory path from file path</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,210 L500,250" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Directory Tracking -->
                    <g class="node process" transform="translate(500, 290)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">3. Directory Tracking</text>
                        <text x="0" y="5" text-anchor="middle">Track PR in directory (avoiding double counting)</text>
                        <text x="0" y="25" text-anchor="middle">Add file to directory's affected files list</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,330 L500,370" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Data Formatting -->
                    <g class="node output" transform="translate(500, 410)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">4. Data Formatting</text>
                        <text x="0" y="5" text-anchor="middle">Convert defect areas object to array format</text>
                        <text x="0" y="25" text-anchor="middle">Sort by defect count (descending)</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,450 L500,490" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Visualization -->
                    <g class="node output" transform="translate(500, 530)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">5. Visualization</text>
                        <text x="0" y="5" text-anchor="middle">Bar Chart: "Areas with Most DEF PRs"</text>
                        <text x="0" y="25" text-anchor="middle">Pie Chart: "DEF PRs Distribution by Area"</text>
                    </g>
                    
                    <!-- Arrowhead definition -->
                    <defs>
                        <marker id="arrowhead2" viewBox="0 0 10 10" refX="9" refY="5"
                            markerWidth="6" markerHeight="6" orient="auto">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#333"></path>
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>
        
        <div class="tab-content" id="guidelines-flow">
            <div class="diagram-container">
                <svg width="1000" height="700" viewBox="0 0 1000 700">
                    <!-- Guidelines Analysis Flow Diagram -->
                    
                    <!-- Size Limit Check -->
                    <g class="node process" transform="translate(500, 50)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">1. Size Limit Check</text>
                        <text x="0" y="5" text-anchor="middle">Calculate total changes (additions + deletions)</text>
                        <text x="0" y="25" text-anchor="middle">Flag PRs with more than 300 lines of changes</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,90 L500,130" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Open Time Check -->
                    <g class="node process" transform="translate(500, 170)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">2. Open Time Check</text>
                        <text x="0" y="5" text-anchor="middle">For open PRs, calculate hours since creation</text>
                        <text x="0" y="25" text-anchor="middle">Flag PRs open for more than 4 hours</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,210 L500,250" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Review Time Check -->
                    <g class="node process" transform="translate(500, 290)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">3. Review Time Check</text>
                        <text x="0" y="5" text-anchor="middle">Calculate time to first review</text>
                        <text x="0" y="25" text-anchor="middle">Flag PRs with first review taking more than 24 hours</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,330 L500,370" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Unresolved Comments Check -->
                    <g class="node highlight" transform="translate(500, 410)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">4. Unresolved Comments Check</text>
                        <text x="0" y="5" text-anchor="middle">Fetch PR reviews and comments</text>
                        <text x="0" y="25" text-anchor="middle">Identify unresolved review comments</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,450 L500,490" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Compliance Calculation -->
                    <g class="node output" transform="translate(500, 530)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">5. Compliance Calculation</text>
                        <text x="0" y="5" text-anchor="middle">Aggregate all non-compliant PRs</text>
                        <text x="0" y="25" text-anchor="middle">Calculate compliance percentage</text>
                    </g>
                    
                    <!-- Arrow -->
                    <path d="M500,570 L500,610" class="edgePath" marker-end="url(#arrowhead)"></path>
                    
                    <!-- Visualization -->
                    <g class="node output" transform="translate(500, 650)">
                        <rect width="280" height="80" rx="5" ry="5" x="-140" y="-40"></rect>
                        <text x="0" y="-15" text-anchor="middle">6. Visualization</text>
                        <text x="0" y="5" text-anchor="middle">Donut Chart: PR Compliance</text>
                        <text x="0" y="25" text-anchor="middle">Tables: Detailed violation lists</text>
                    </g>
                    
                    <!-- Arrowhead definition -->
                    <defs>
                        <marker id="arrowhead3" viewBox="0 0 10 10" refX="9" refY="5"
                            markerWidth="6" markerHeight="6" orient="auto">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#333"></path>
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>
    </div>
    
    <script>
        function showTab(tabId) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Deactivate all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Activate the clicked tab button
            const clickedButton = Array.from(tabButtons).find(button => 
                button.getAttribute('onclick').includes(tabId)
            );
            clickedButton.classList.add('active');
        }
    </script>
</body>
</html>
